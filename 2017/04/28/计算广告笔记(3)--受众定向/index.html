<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="VcC-PHB4Om9SIR3Roqm7k1N-SHiBtQ6c3LJLVMKgU4U" />










  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="机器学习,计算广告," />





  <link rel="alternate" href="/atom.xml" title="吴良超的学习笔记" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="这一讲主要介绍了受众定向的概念和若干种定向的方法。
受众定向概念受众定向是目前广告系统的核心部分，要做的就是根据人群划分进行广告售卖和优化。
受众定向可以认为是为 AUC（Ad，User，Context）打标签的过程，上下文标签可以认为是即时受众标签，如下所示是AUC上的标签类别">
<meta property="og:type" content="article">
<meta property="og:title" content="计算广告笔记(3)--受众定向">
<meta property="og:url" content="http://wulc.github.io/2017/04/28/计算广告笔记(3)--受众定向/index.html">
<meta property="og:site_name" content="吴良超的学习笔记">
<meta property="og:description" content="这一讲主要介绍了受众定向的概念和若干种定向的方法。
受众定向概念受众定向是目前广告系统的核心部分，要做的就是根据人群划分进行广告售卖和优化。
受众定向可以认为是为 AUC（Ad，User，Context）打标签的过程，上下文标签可以认为是即时受众标签，如下所示是AUC上的标签类别">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/oeuckcc9zz78ooe0aa7nw4iu/image_1bemrnn561kk85bhka521jii9.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/00v9yd7c7buy3vupe1l98tg4/image_1bi17ii0n2qr1s3169rersvho1t.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/dzh8nxfhswr4zfz1f9jnf8fn/image_1bi0joe626h46ri1vhc137216o9m.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/wlpn8or60r4p450sjv50u5qh/image_1ben0lcj01qsn1j1m2ji1o9a11ao1g.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/zhgpsn31bps5mmzhpiowp0jl/image_1ben1h50a2kf1kou1rea1qad1l7e1t.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/eyqknqurxttjs6mqsb0w6b7g/image_1ben1i4ub15gve341f251kp89b92a.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/1zenpb0voh2sk8uoahcv11fz/image_1ben1to0fpsr1unj1aao66qu232n.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/osn2015vgarppyjrwjy2axzo/image_1ben5m1qh1idkc571i9v1n21u3p34.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/zp4cwe8ncoeu7hi4mhgt2192/image_1bi41ptsp1junofgd5satp1d3dm.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/69jx9y278oxf0jf769wvktjk/image_1bi59lp0fpu112r111hoq6m1d702a.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/klf0ms0ko87n13qx8fhemfzh/image_1bep1f616m1h1k4e1jtl1tp61jrn13.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/gjlpjce6hs0dak0qxnuzgjmw/image_1ben9omrm1ko71qrkp2kl6u13bc4o.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/iku61kp5mjy8x5qzqsuo3m83/image_1benb74qa1au91vh21t2b1kifi55.png">
<meta property="og:image" content="http://static.zybuluo.com/WuLiangchao/hvp3d7oxtstj37vdxk99aaoj/image_1bep5kb521id3iav1vlo7dcl3a9.png">
<meta property="og:updated_time" content="2018-12-21T11:53:29.221Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="计算广告笔记(3)--受众定向">
<meta name="twitter:description" content="这一讲主要介绍了受众定向的概念和若干种定向的方法。
受众定向概念受众定向是目前广告系统的核心部分，要做的就是根据人群划分进行广告售卖和优化。
受众定向可以认为是为 AUC（Ad，User，Context）打标签的过程，上下文标签可以认为是即时受众标签，如下所示是AUC上的标签类别">
<meta name="twitter:image" content="http://static.zybuluo.com/WuLiangchao/oeuckcc9zz78ooe0aa7nw4iu/image_1bemrnn561kk85bhka521jii9.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://wulc.github.io/2017/04/28/计算广告笔记(3)--受众定向/"/>





  <title> 计算广告笔记(3)--受众定向 | 吴良超的学习笔记 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  








  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1258114456&web_id=1258114456" language="JavaScript"></script>
  </div>





  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">吴良超的学习笔记</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description"></h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            站内搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://wulc.github.io/2017/04/28/计算广告笔记(3)--受众定向/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="良超">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://wulc.me/files/profile.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="吴良超的学习笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="吴良超的学习笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                计算广告笔记(3)--受众定向
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-28T21:37:39+08:00">
                2017-04-28
              </time>
            

            

            
          </span>


          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-tags"></i>
              </span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/tags/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/tags/计算广告/" itemprop="url" rel="index">
                    <span itemprop="name">计算广告</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>这一讲主要介绍了受众定向的概念和若干种定向的方法。</p>
<h2 id="受众定向概念"><a href="#受众定向概念" class="headerlink" title="受众定向概念"></a>受众定向概念</h2><p>受众定向是目前广告系统的核心部分，要做的就是根据人群划分进行广告售卖和优化。</p>
<p>受众定向可以认为是为 AUC（Ad，User，Context）打标签的过程，上下文标签可以认为是即时受众标签，如下所示是AUC上的标签类别</p>
<a id="more"></a>
<p><img src="http://static.zybuluo.com/WuLiangchao/oeuckcc9zz78ooe0aa7nw4iu/image_1bemrnn561kk85bhka521jii9.png" alt="AUC上的标签系统"></p>
<p>标签的两大主要作用</p>
<ol>
<li>建立面向广告主的流量售卖体系，注意这些特征需要有具体的意义才能展现给广告主，一般通过事先定义而不是通过文本聚类方法获取</li>
<li>为各估计模块(如CTR预测)提供原始特征</li>
</ol>
<p>下图的定向方式从右到左效果逐渐变好，从上到下表示不同阶段的定向方式；</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/00v9yd7c7buy3vupe1l98tg4/image_1bi17ii0n2qr1s3169rersvho1t.png" alt="定向方式"></p>
<p>上图中的 $f(u)$, $f(c)$, $f(a,u)$ 含义如下：</p>
<p>$f(u)$：用户标签，即根据用户历史行为给用户打上的标签<br>$f(c)$：上下文标签，即根据用户当前的访问行为得到的即时标签<br>$f(a,u)$：定制化标签，也是一种用户标签，但是是针对某一广告主而言</p>
<p>除了上面提到的三种标签还有一中标签 $f(a)$ 表示广告标签，便于与上下文标签或用户标签做匹配。广告标签常常有两种选择<br>1）直接将广告投放中的广告主、广告计划、广告组、关键词等直接作为标签<br>2）用人工的方式归类</p>
<p>除此之外，各种定向方式中的数字表示该方式有利于某个个阶段需要遵循的原则，各个阶段及其需要遵循原则如下所示</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/dzh8nxfhswr4zfz1f9jnf8fn/image_1bi0joe626h46ri1vhc137216o9m.png" alt="各阶段主要原则"></p>
<p>各种定向方式含义如下所示：<br><strong>重定向</strong>：如果用户曾经访问过广告主的网站，就会给用户推该广告主的广告。（品牌广告较为常用）<br><strong>上下文</strong>：用户目前浏览的网页内容相关的广告<br><strong>行为</strong>：根据用户的历史行为进行推荐<br><strong>网站/频道</strong>：根据网站的属性投放与该网站内容相关的某一领域的广告（如汽车广告）<br><strong>Hyper-local</strong>：将定位做得更细（如定位到某条街道的小饭馆，一般在移动广告较容易实现）<br><strong>Look-alike</strong>：一般来说重定向的量比较少，该方式可以找到与广告主提供的种子用户相似的用户进行广告投放<br><strong>人口属性</strong>：人口，性别，教育水平，收入水平等，主要给广告商看，效果不是很好<br><strong>地域</strong>：主要给广告商看，效果不是特别好</p>
<p>下面介绍一下audience targeting 在业界的一种商业模式</p>
<p>Audience Science 是一个做audience targeting的第三方发公司，其核心业务有两个：</p>
<ol>
<li>主要提供面向publisher（如NewYork Times）的数据加工服务，从publisher提供的数据中提取出用户标签供 publisher 使用</li>
<li>直接运营ad network，并帮助广告主进行campaign管理和优化；该过程中会通过上面提取出来的用户标签优化效果，同时使用标签创造的营收按照一定比例跟publisher分成</li>
</ol>
<h2 id="行为定向"><a href="#行为定向" class="headerlink" title="行为定向"></a>行为定向</h2><p>根据用户的历史行为给用户打上标签(上面提到的$f(u)$)，下面是九种重要原始行为(按信息强度排序，往往强度越大，量越少)</p>
<ol>
<li>Transaction, 就是用户购买行为 </li>
<li>Pre-transaction, 用户购买前的一些行为，如商品浏览、加入购物车等</li>
<li>Paid search click, 搜索广告中的点击行为</li>
<li>Ad click, 广告的点击行为</li>
<li>Search click, 搜索引擎上的点击行为</li>
<li>Search, 搜索引擎上的搜索行为</li>
<li>Share, 分享行为，如微博等</li>
<li>Page View, 浏览页面的行为，注意这个页面不是上面搜索出来的页面，而是用户在某个站点中只能看到的页面（如贴吧），量大但是效果一般</li>
<li>Ad view，看某个广告的次数，但是带来的效果往往是负面的</li>
</ol>
<p>行为定向计算的一种方式如下 ($t^{(i)}(u)$表示用户 $u$ 在标签 $i$ 上的强度)</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/wlpn8or60r4p450sjv50u5qh/image_1ben0lcj01qsn1j1m2ji1o9a11ao1g.png" alt="定向行为计算"></p>
<p>上面的方式比较简单，但是在海量数据中首先要做的是shallow的挖掘。</p>
<p>行为定向的还有其他一些问题：如 session log 和 long-term 行为定向</p>
<p><strong>Session log</strong></p>
<p>session log 关系到怎么从日志文件中提取出所需数据，有以下两点建议</p>
<ol>
<li>将各种行为日志整理成<strong>以用户ID为key的形式</strong>，完成作弊和无效行为标注，作为各数据处理模块的输入源</li>
<li>可以将targeting变成<strong>局部计算</strong>，大大方便整个流程</li>
</ol>
<p><strong>Long-term 行为定向</strong></p>
<p>Long-term 行为定向指的是如何从用户的长期行为中提取出用户的标签，常用的有两种方法：滑动窗口方式和时间衰减方式。</p>
<p>滑动窗口方式：直接将前面 $T$ 天的行为标签进行相加。下面的公式中 $f$ 为 long-term 标签，下标为日期</p>
<p>$$f_d^{(i)}(u) = \sum_{j=0}^T t_{d-j}^{(i)}(u)$$</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/zhgpsn31bps5mmzhpiowp0jl/image_1ben1h50a2kf1kou1rea1qad1l7e1t.png" alt="滑动窗口方式"></p>
<p>时间衰减方式：按照时间衰减方式，对前n天的标签进行相加，时间越长，权重越小。这种方式<strong>空间复杂度低</strong>，仅需昨天的 $f$ 和今天的 $t$</p>
<p>$$f_d^{(i)}(u) = t_{d}^{(i)}(u) + \alpha f_{d-1}^{(i)}(u)$$</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/eyqknqurxttjs6mqsb0w6b7g/image_1ben1i4ub15gve341f251kp89b92a.png" alt="指数衰减方式"></p>
<p>实际中上面两种方法的效果差异不大，但是时间衰减方式的计算代价较小。$T$ 的选择与实际商品相关，如汽车的 $T$ 往往较大，而运动鞋的 $T$ 往往不大，目前这个值主要是根据经验来设。</p>
<p><strong>如何评判为用户打的标签？</strong></p>
<p>受众定向评测可以借助Reach/CTR曲线，该曲线如下所示，横轴表示reach到的用户，纵轴表示广告点击率</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/1zenpb0voh2sk8uoahcv11fz/image_1ben1to0fpsr1unj1aao66qu232n.png" alt="Reach/CTR曲线"></p>
<p>上图从左到右阈值设置逐渐变小，设为0时，可以reach到所有人，但是这个时候就相当于无定向投放了</p>
<p>注意拐点以及该曲线是否服从一个递减的趋势；如果不是递减，可能标签没意义，而拐点可以知道设置在哪一个值能够将有更强的购买倾向的人群与其他人群分开。</p>
<h2 id="上下文定向"><a href="#上下文定向" class="headerlink" title="上下文定向"></a>上下文定向</h2><p>上下文定向指的是根据用户的访问内容给用户打标签 (上面提到的 $f(c)$)，这样的定向中有一些根据广告请求中的参数经过简单运算就可以得到，如地域定向，频道/URL 定向、操作系统定向等。另外一类则是根据上下文页面的一些特征标签，如关键词、主题、分类等进行定向，下面重点讨论这种上下文定向方式。</p>
<p>上下文定向（打标签）主要有以下几种思路：<br>1）用规则将页面归类到一些频道或主题分类，如将 auto.sohu.com 归类到“汽车”的分类中<br>2）提取页面的关键词<br>3）提取页面的入链锚文本中的关键词，这需要一个全网的爬虫作支持<br>4）提取网页流量来源中的搜索关键词，这种方法除了页面内容，也需要页面访问的日志数据作支持<br>5）用主题模型将页面内容映射到语义空间的一组主题上</p>
<h3 id="半在线抓取系统"><a href="#半在线抓取系统" class="headerlink" title="半在线抓取系统"></a>半在线抓取系统</h3><p>确定了对上下文页面打标签的方法后，在在线广告投放时，页面标签系统需要某个查询 url 返回其对应的标签。在广告系统中，可以通过<strong>半在线(Near-line)上下文定向系统</strong>实现这个事情，如下就是一个 Near-line 上下文定向系统 </p>
<p><img src="http://static.zybuluo.com/WuLiangchao/osn2015vgarppyjrwjy2axzo/image_1ben5m1qh1idkc571i9v1n21u3p34.png" alt="near-line 上下文定向系统"></p>
<p>该系统用一个缓存(Redis)来保存每个 URL 对应的标签，当在线广告请求到达的时候，执行如下操作</p>
<ol>
<li>如果请求的上下文 URL 在缓存中存在，直接返回其对应的标签</li>
<li>如果 URL 在缓存中不存在，为了广告请求能够及时得到处理，立刻返回空的标签集合，同时向后台的抓取队列中加入此 URL 进行抓取和存储</li>
<li>考虑到页面的内容会不定期更新，可以设置缓存合适的 TTL 以自动更新 URL 对应的标签</li>
</ol>
<p>步骤 2 中能够返回空标签的原因是在广告系统中，某一次展示时标签的缺失带来的影响是可以忍受的，因为对于广告系统而言，这部分只是起到一个锦上添花的作用。</p>
<h3 id="主题模型"><a href="#主题模型" class="headerlink" title="主题模型"></a>主题模型</h3><p>除了直接提取页面内容的关键词作为页面的特征以外，还可以通过主题模型（Topic models）这一类模型对文本进行聚类得到文本的主题分布情况。</p>
<p>主题模型分两大类：<strong>有监督和无监督的</strong>。有监督指的是预先定义好主题的集合，用监督学习的方法将文档映射到这一集合的元素上；无监督指的是不预先定义主题集合，而是控制主题的总个数或聚类程度，用非监督的方法自动学习出主题集合以及文档到这些主题的映射函数。</p>
<p>广告中的主题挖掘有两种用途</p>
<ol>
<li>用于广告效果优化的特征提取</li>
<li>用于售卖给广告主的标签体系</li>
</ol>
<p>对于第一种用途, 用有监督或非监督的方法都可以；对于第二种用途，应该优先考虑采用监督学习的方法，因为这样可以预先定义好对广告主有意义而且可解释的标签体系。下面先介绍非监督方法，再介绍监督方法。</p>
<p><strong>非监督方法</strong></p>
<p>非监督的主题模型的发展经历了 <strong>LSA -&gt; PLSA -&gt; LDA</strong> 的过程，下面简单介绍这三种模型。</p>
<p>LSA(Latent Semantic Analysis) 有时也叫 LSI(Latent Semantic Indexing)，这种方法实际上是将 SVD 分解应用到了 “文本-单词” 矩阵中，即</p>
<p>$$X \approx U \Sigma V^T$$</p>
<p>$X$ 矩阵中的值有多种选择：0-1，出现次数，TF-IDF值。则 $U$ 矩阵的一行对应的就是一篇文本在各个主题上的分布， $V$  矩阵每行对应的就是一个单词在各个主题上的分布，而选择奇异值的个数则决定了隐含主题的个数，也就是代表文本或词语的向量的维度。通过比较向量间的余弦相似性，便可比较文本或单词间的相似性。</p>
<p>这样的方法虽然直观，但是有几个问题，一是分解后矩阵 $U$、$V$ 中可能存在着负值，二是这些数值在概率上没有意义。为了解决这些问题，便提出了PLSA。</p>
<p>PLSA(Probabilistic Latent Semantic Analysis)可以说是概率化了的LSA，但是采用的方法与 LSA 完全不同，PLSA 没有涉及到 SVD，而是采用混合模型的做法。</p>
<p>PLSA 方法假设文本包含多个主题，这些主题服从多项式分布，而每个主题下的有多个词，这些词也服从多项式分布。假设有 M 篇文档，每篇文档有 N 个词，则生成这 M 篇文档的过程通过有向图模型表示如下</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/zp4cwe8ncoeu7hi4mhgt2192/image_1bi41ptsp1junofgd5satp1d3dm.png" alt="PLSA"></p>
<p>在有向图模型中，灰色的点表示能够观察到的点，其他白色的点表示需要求解的点，而最后需要求解的点是没有入度的点，其他的有入度和出度的点会被积分积掉，框及其框内符号表示框里面的内容重复若干次</p>
<p>而上图中 $d$ 表示文本，$c$ 表示主题， $w$ 表示词语，且文本 $d$ 中生成词语 $w_i$ 的概率是</p>
<p>$$P(w_i|d) = \sum_c P(c|d) P(w_i|c)$$</p>
<p>其中 $P(c|d)、 P(w|c)$均服从多项式分布</p>
<p>则整篇文本生成的概率为</p>
<p>$$P(d) = \prod_i P(w_i|d) $$</p>
<p>这个模型跟混合高斯模型（mixture of Gaussian）非常相似，都是融合了多个指数族分布的模型，这一类模型也可以称为混合模型，而求解这一类的问题的方法便是 EM 算法，这里不详细展开。除此之外，假如将上面 PLSA 中文本主题服从的多项式分布改为伽马分布，将主题下的词语服从的多项式分布改为泊松分布，那么 PLSA 就变为了GaP(Gamma-Poisson)模型。</p>
<p>LDA(Latent Dirichlet Allocation) 则是在 PLSA 的基础上为其两个多项式分布加上了贝叶斯先验, 先验选为 Dirichelet 分布，原因是更多是数学上的便利性，因为Dirichelet 是 multinational 的共轭先验，容易求解。</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/69jx9y278oxf0jf769wvktjk/image_1bi59lp0fpu112r111hoq6m1d702a.png" alt="LDA"></p>
<p>上图中 $\alpha$, $\beta$ 表示参数为 $\alpha$, $\beta$ 的狄利赫里分布，这两个分布分别是文本的主题概率分布和主题下词语的概率分布的先验分布。文本的主题概率分布的先验分布为</p>
<p>$$ \theta_i \sim Dir(\alpha),~i=1, 2…M $$</p>
<p>$\theta_i$ 表示第 $i$ 篇文档的主题分布，而 $\theta_{i,k}（k=1,2…K）$ 表示第 $i$ 篇文档中包含第 $k$ 个主题的概率</p>
<p>而主题下的词语的概率分布的先验分布为</p>
<p>$$ \phi _k \sim Dir(\beta),~k=1,2…K $$</p>
<p>$\phi_k$ 表示第 $k$ 个主题下的词语分布，而 $\phi_{k,j}（j=1,2…V）$ 表示第 $k$ 个主题中包含第 $j$ 个词的概率，$V$ 为语料库的词表的大小</p>
<p>确认先验分布后，文档中的主题分布以及主题下的词语分布均服从多项式分布，与 PLSA 相同，求解 LDA 得思路是先求解出其最终的联合概率分布，然后通过 Gibbs Sampling 收敛到该概率。</p>
<h3 id="经验贝叶斯-Empirical-Bayes"><a href="#经验贝叶斯-Empirical-Bayes" class="headerlink" title="经验贝叶斯(Empirical Bayes)"></a>经验贝叶斯(<a href="https://en.wikipedia.org/wiki/Empirical_Bayes_method" target="_blank" rel="external">Empirical Bayes</a>)</h3><p>如下图模型, 如何确定hyperparameter $\eta$?</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/klf0ms0ko87n13qx8fhemfzh/image_1bep1f616m1h1k4e1jtl1tp61jrn13.png" alt="经验贝叶斯"></p>
<p>用 Empirical Bayes 估计的解为：$$\widehat \eta = arg \max_{\eta} \int \prod_{k=1}^{K}p(D_k|\theta_k)p(\theta_k|\eta)d\theta_k$$</p>
<p>当 $p(x|\theta)$ 为指数族分布，$p(\theta|\eta)$ 为其共轭先验时，可用EM求解, 其中E-step为Bayesian inference过程, 由 $\eta^{old}$ 得到后验参数 $\widetilde \eta_k^{old}$ , 而M-step为:$$(\theta, ln[g(\theta)])_{\eta^{new}} = \frac{1}{K}\sum_{k=1}^{K}(\theta, ln(g(\theta)))_{\widetilde \eta_k^{old}}$$</p>
<h3 id="从经验贝叶斯看LDA"><a href="#从经验贝叶斯看LDA" class="headerlink" title="从经验贝叶斯看LDA"></a>从经验贝叶斯看LDA</h3><p>LDA可以视为PLSI的经验贝叶斯版本，由于PLSI不是指数族分布，而是其混合分布，因此其贝叶斯版本不能使用前面的EM算法。工程上常用的求解方法有两种：Deterministic inference 和 Probabilistic inference</p>
<p><strong>Deterministic inference</strong>： 可用变分近似，假设z和θ的后验分布独立迭代求解过程与EM非常相似，称为VBEM，但是在大多数问题上无法保证收敛到局部最优</p>
<p><strong>Probabilistic inference</strong>: 可用Gibbs-sampling(Markov-chain Monte-Carlo, MCMC 的一种)，以概率1收敛到局部最优值；还有一种方法是 Collapsed  Gibbs-sampling</p>
<h3 id="Topic-model的并行化"><a href="#Topic-model的并行化" class="headerlink" title="Topic model的并行化"></a>Topic model的并行化</h3><ul>
<li><p>EM及VBEM的并行化较为简单</p>
<ul>
<li>E-step(mapper): 可以方便地并行计算</li>
<li>M-step(reducer): 累加E-step各部分统计量后更新模型</li>
<li>将更新后的模型分发到新的E-step各个计算服务器上</li>
</ul>
</li>
<li><p>AD-LDA: Gibbs Sampling的并行化</p>
<ul>
<li>Mapper: 在部分data上分别进行Gibbs sampling</li>
<li>Reducer: 全局Update</li>
</ul>
</li>
</ul>
<p>$$n_{i,j} \leftarrow n_{i,j}+\sum_p(n_{i,j,p} - n_{i,j}),~n_{i,j,p}\leftarrow n_{i,j}$$</p>
<p>文档的Topic model抽取可以认为是一个大量(而非海量)数据运算，采用类MPI架构的分布式计算架构(例如spark)会比 MapReduce 效率更高</p>
<p>虽然LDA能够聚类，但是supervisord learning 对标签体系更有意义。 </p>
<h2 id="数据加工和交易"><a href="#数据加工和交易" class="headerlink" title="数据加工和交易"></a>数据加工和交易</h2><p>精准的广告业务是什么？下面的图将数据的加工过程类比于石油的加工和提炼的过程，在这个过程中，实际上与媒体的关系已经不大了。</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/gjlpjce6hs0dak0qxnuzgjmw/image_1ben9omrm1ko71qrkp2kl6u13bc4o.png" alt="精准广告业务"></p>
<h3 id="精准广告业务的若干值得探讨的观点"><a href="#精准广告业务的若干值得探讨的观点" class="headerlink" title="精准广告业务的若干值得探讨的观点"></a>精准广告业务的若干值得探讨的观点</h3><ul>
<li>越精准的广告，给市场带来的价值越大</li>
<li>媒体利益与广告主利益是相博弈的关系</li>
<li>精准投放加上大数据可以显著提高营收</li>
<li>人群覆盖率较低的数据来源是不需要的（长尾？）</li>
<li>不同的广告产品应该采用不同的投放机</li>
</ul>
<h3 id="有价值的数据"><a href="#有价值的数据" class="headerlink" title="有价值的数据"></a>有价值的数据</h3><p>下面列出了一些在广告系统中有价值的数据</p>
<ul>
<li>用户标识<ul>
<li>除上下文和地域外各种定向的基础，需要长期积累和不断建设</li>
<li>可以通过多家第三方ID绑定不断优化</li>
</ul>
</li>
<li>用户行为<ul>
<li>业界公认有效行为数据（按有效性排序）</li>
<li>交易，预交易，搜索广告点击，广告点击，搜索，搜索点击，网页浏览，分享，广告浏览</li>
<li>需去除网络热点话题带来的偏差</li>
<li>越靠近demand的行为对转化越有贡献</li>
<li>越主动的行为越有效</li>
</ul>
</li>
<li>广告商(Demand)数据<ul>
<li>简单的cookie植入可以用于retargeting。</li>
<li>对接广告商种子人群可以做look-alike，提高覆盖率。</li>
</ul>
</li>
<li>用户属性和精确地理位置<ul>
<li>非媒体广告网络很难获取，需通过第三方数据对接。</li>
<li>移动互联和HTML5为获得地理位置提供了便利性。</li>
</ul>
</li>
<li>社交网络<ul>
<li>朋友关系为用户兴趣和属性的平滑提供了机会</li>
<li>实名社交网络的人口属性信息相对准确</li>
</ul>
</li>
</ul>
<h3 id="数据管理平台-Data-Management-Platform"><a href="#数据管理平台-Data-Management-Platform" class="headerlink" title="数据管理平台(Data Management Platform)"></a>数据管理平台(Data Management Platform)</h3><ul>
<li>目的:<ul>
<li>为网站提供数据加工和对外交易能力(如Audience Science)</li>
<li>加工跨媒体用户标签，在交易市场中售卖</li>
<li>是否应直接从事广告交易存在争议</li>
</ul>
</li>
<li>关键特征: <ul>
<li>定制化用户划分</li>
<li>统一的对外数据接口：demand端提供给supply端</li>
</ul>
</li>
<li>代表: <ul>
<li>Bluekai, AudienceScience</li>
</ul>
</li>
</ul>
<p>DMP的系统架构示意图如下所示</p>
<p><img src="http://static.zybuluo.com/WuLiangchao/iku61kp5mjy8x5qzqsuo3m83/image_1benb74qa1au91vh21t2b1kifi55.png" alt="DMP架构"></p>
<p>DMP主要是Data highway部分，主要完成两个工作：</p>
<ol>
<li>挖掘出各个用户的标签</li>
<li>利用挖掘出来的用户的标签，售卖或使用</li>
</ol>
<p>这里介绍一个Data Highway 的工具：<strong>Scribe</strong></p>
<ul>
<li>大规模分布式日志收集系统，可以准实时收集大量日志到 HDFS，利用Thrift实现底层服务</li>
<li>类似工具: Flume, Chukwa</li>
</ul>
<p><img src="http://static.zybuluo.com/WuLiangchao/hvp3d7oxtstj37vdxk99aaoj/image_1bep5kb521id3iav1vlo7dcl3a9.png" alt="scribe"></p>
<p>这个工具在 Facebook 经过实践，验证了其面对大规模数据时的可靠性。</p>
<p>下面介绍一下audience targeting 在业界的一种商业模式<br>上面提到了Bluekai这个公司，其核心业务主要有以下两个：</p>
<ol>
<li>为中小网站主提供数据加工和变现的方式</li>
<li>通过汇聚众多中小网站用户资料和行为数据，加工成受众定向标签，通过Data exchange对外售卖</li>
</ol>
<p>Bluekai 提供大量细分类别、开放体系上的标签，如“对宝洁洗发水感兴趣的人”，“想去日本旅游的人”；靠数据出售变现，并与提供数据的网站主分成，但是并不直接运营广告业务；对于设计用户隐私的问题，用户可以看到自己的资料被谁使用，也可以选择“捐给慈善机构”</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/机器学习/" rel="tag">机器学习</a>
          
            <a href="/tags/计算广告/" rel="tag">计算广告</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/25/计算广告笔记(2)--合约广告系统/" rel="next" title="计算广告笔记(2)--合约广告系统">
                <i class="fa fa-chevron-left"></i> 计算广告笔记(2)--合约广告系统
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/07/计算广告笔记(4)--竞价广告系统/" rel="prev" title="计算广告笔记(4)--竞价广告系统">
                计算广告笔记(4)--竞价广告系统 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://wulc.me/files/profile.jpg"
               alt="良超" />
          <p class="site-author-name" itemprop="name">良超</p>
          <p class="site-description motion-element" itemprop="description">算法工程师首先得是个工程师</p>
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">204</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">39</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/WuLC" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.linkedin.com/in/wuliangchao/" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  Linkedin
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#受众定向概念"><span class="nav-number">1.</span> <span class="nav-text">受众定向概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#行为定向"><span class="nav-number">2.</span> <span class="nav-text">行为定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#上下文定向"><span class="nav-number">3.</span> <span class="nav-text">上下文定向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#半在线抓取系统"><span class="nav-number">3.1.</span> <span class="nav-text">半在线抓取系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#主题模型"><span class="nav-number">3.2.</span> <span class="nav-text">主题模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#经验贝叶斯-Empirical-Bayes"><span class="nav-number">3.3.</span> <span class="nav-text">经验贝叶斯(Empirical Bayes)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#从经验贝叶斯看LDA"><span class="nav-number">3.4.</span> <span class="nav-text">从经验贝叶斯看LDA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Topic-model的并行化"><span class="nav-number">3.5.</span> <span class="nav-text">Topic model的并行化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据加工和交易"><span class="nav-number">4.</span> <span class="nav-text">数据加工和交易</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#精准广告业务的若干值得探讨的观点"><span class="nav-number">4.1.</span> <span class="nav-text">精准广告业务的若干值得探讨的观点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#有价值的数据"><span class="nav-number">4.2.</span> <span class="nav-text">有价值的数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据管理平台-Data-Management-Platform"><span class="nav-number">4.3.</span> <span class="nav-text">数据管理平台(Data Management Platform)</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <center>
<div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2019</span>
  &nbsp;&nbsp;|&nbsp;&nbsp;Powered by <a href="http://hexo.io">Hexo</a> and <a href="http://theme-next.iissnan.com/">NexT</a></span>
  </br>
  <span>Documentation Licensed Under <a href="https://creativecommons.org/licenses/by/4.0/deed.en">CC BY 4.0</a></span>
</div>
</center>



        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  
<script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>


  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


</body>
</html>
